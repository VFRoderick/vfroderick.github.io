<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { 
      width: 100%; 
      height: 100%; 
      overflow: hidden;
      background: transparent;
    }
    .chart-container {
      width: 100%;
      height: 100%;
      padding: 10px;
    }
    canvas { 
      width: 100% !important; 
      height: 100% !important; 
    }
  </style>
</head>
<body>
  <div class="chart-container">
    <canvas id="chart"></canvas>
  </div>
  <script>
    Chart.register(ChartDataLabels);
    
    const ctx = document.getElementById('chart').getContext('2d');
    
    new Chart(ctx, {
      type: 'bar',
      data: {
        labels: ['Q3 22','Q4 22','Q1 23','Q2 23','Q3 23','Q4 23','Q1 24','Q2 24','Q3 24','Q4 24','Q1 25','Q2 25','Q3 25'],
        datasets: [
          {
            label: 'Enterprise Entitlements',
            data: [123, 133, 155, 187, 223, 236, 272, 313, 368, 444, 525, 717, 981],
            backgroundColor: '#5B3E6B'
          },
          {
            label: 'AGOL Entitlements', 
            data: [47, 61, 171, 229, 299, 370, 439, 554, 678, 801, 967, 1188, 1436],
            backgroundColor: '#1B7F79'
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        layout: {
          padding: { top: 5, bottom: 5, left: 5, right: 5 }
        },
        scales: { 
          x: { 
            stacked: true,
            ticks: { font: { size: 9 } }
          }, 
          y: { 
            stacked: true, 
            max: 2500,
            ticks: { font: { size: 9 } }
          } 
        },
        plugins: { 
          legend: { 
            position: 'bottom',
            labels: { font: { size: 10 }, boxWidth: 12 }
          },
          title: {
            display: true,
            text: 'GIS Adoption at Mortenson',
            font: { size: 14, weight: 'bold' }
          },
          datalabels: {
            color: '#fff',
            font: { size: 8, weight: 'bold' },
            anchor: 'center',
            align: 'center',
            formatter: function(value, context) {
              // Only show label if bar segment is tall enough
              const chart = context.chart;
              const meta = chart.getDatasetMeta(context.datasetIndex);
              const bar = meta.data[context.dataIndex];
              const barHeight = bar.height;
              
              // Hide label if bar is too short (less than 18px)
              if (barHeight < 18) return '';
              return value;
            }
          }
        }
      }
    });
  </script>
</body>
</html>
